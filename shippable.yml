# language setting
language: node_js

# version numbers, testing against one version of node
node_js:
    - 0.10.33

env:
    global:
        - XUNIT_FILE=./shippable/testresults/result.xml
        - secure: M8kY97pkOqDRsDcd/qvYf23jq/P4ZKQ/OHZ9mmGawIwqD+I5i3aQPmt00E5I1ueohbqo754wTDnf9e5ZrEqVl4JyaR1WuApvWKOZX4mQu5kpeDyP58eikLYG8jPisK2De5oA42MFLuwvFfxekYhz15Ycvm94QEx9SLZOsKdA4EGHBbWM8xduK2n4SQIrw1ixqabtnn5NGko7HtydG75UmMrJIatiWO28BGdtv6tA+SreisGNtrZa4o1oJsesbQXGkuJ2ysE6nr01Pkr9bMGC6TFYxbn0FISyyuxnZIbx7NaDXLqPQ2TgkIq/+5pEnwvYYouBbkY7UQSisAMQE8SP2Q==
        # You'll need to replace the above hash with one based on your own personal access token from your GitHub account settings.
        # For instructions to encrypt this variable, see http://docs.shippable.com/project_settings/#encrypt-environment-variables

before_install:
#    - cd $SHIPPABLE_REPO_DIR
    - node --version
    - npm install -g grunt-cli
    - mkdir -p ./shippable/testresults
    - mkdir -p ./shippable/codecoverage

install:
#    - pwd
    - npm install

script:
    - mkdir -p ./shippable/buildoutput
    - touch ./shippable/buildoutput/config.txt
    - echo $BUILD_NUMBER > ./shippable/buildoutput/config.txt
    - grunt

after_script:
    - ./node_modules/.bin/istanbul cover grunt -- -u tdd
    - ./node_modules/.bin/istanbul report cobertura --dir  ./shippable/codecoverage/

notifications:
    on_success: always
    on_failure: always
    
branches:
    only:
        - master
    
